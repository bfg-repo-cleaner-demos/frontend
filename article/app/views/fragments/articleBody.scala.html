@(article: Article, storyPackage: List[Trail])(implicit request: RequestHeader)

<h2 class="page-head page-head--article">
    <a data-link-name="article section" href="/@article.section">@Html(article.sectionName)</a>
</h2>

<article id="article" class="article @if(article.isLive){is-live}"
    itemprop="mainContentOfPage" itemscope itemtype="@article.schemaType" role="main">

    <header class="article__head">
        <div class="snap-to-grid">
            @fragments.dateline(article.webPublicationDate, article.isLive)
            @fragments.headline(article.headline)
        </div>
        <div class="article__standfirst snap-to-grid">
            @fragments.standfirst(article)
        </div>
    </header>

    @fragments.witnessCallToAction(article)

    <div class="after-header"></div>

    @if(!article.isLive && !article.hasVideoAtTop) {
        @article.mainPicture.map{ mainPicture =>
            @article.mainPicture(width=220).map{ smallCrop =>
                @fragments.img(mainPicture, smallCrop)
            }
        }
    }

    <div class="article__byline">
        @fragments.byline(article.byline, article)
    </div>

    <div class="article__body from-content-api @if(article.isLive) {live-blog}"
        itemprop="@if(article.isReview){reviewBody} else {articleBody}">

        @if(article.isLive) {
            @fragments.autoUpdate()
        }

        @* <!-- ordering of cleaners is important --> *@
        @withJsoup(BulletCleaner(article.body))(
            PictureCleaner(article),
            InBodyLinkCleaner("in body link"),
            BlockNumberCleaner,
            TweetCleaner,
            WitnessCleaner,
            VideoPosterCleaner(article.videoAssets)
        )
    </div>

    @fragments.social(article)

</article>

@if(storyPackage.nonEmpty) {
    <aside role="complementary">
        @fragments.relatedTrails(storyPackage, heading = "More on this story", visibleTrails = 5)
    </aside>
} else {
    <aside class="js-related" role="complementary"></aside>
}

<div   class="js-popular" role="complementary"></div>
