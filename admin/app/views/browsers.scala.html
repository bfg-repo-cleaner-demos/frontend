@(env: String, os: Map[String, Long], browser: Map[String, Long], combined: Map[String, Long])

@admin_main("Browsers", env, isAuthed = true) {

    <h1>Browser usage on theguardian.com</h1>
    
    <p>
        Collected from Ophan data covering March 1, 2013 to present.
    </p>
    
    <h3>By operating system and browser</h3>

    <p>
        Page views over 10k broken down by combined operating system and browser version across mobile and desktop.
    </p>

    <p>
       total views = @{combined.map {_._2}.sum}
    </p>



    <table class="table table-bordered table-striped table-condensed browser-table" data-total="@{combined.map {_._2}.sum}">
        <caption>
            <input type="text" class="input-medium search-query" placeholder="Filter...">
        </caption>
        <thead>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
            <tr class="legend">
                <td></td>
                <td>
                    5.0 2000<br>
                    5.1 XP<br>
                    5.2 Server 2003<br>
                    6.0 Server 2008 & Vista<br>
                    6.1 Win 7<br>
                    6.2 Win 8<br>
                    6.3 RT<br>
                </td>
                <td></td>
            </tr>
        </thead>
        <tbody>
        @combined.toList.sortBy{_._2}.reverse.take(300).zipWithIndex.map { case (row, index) =>
            <tr>
                <td>@{index + 1}</td>
                <td>@row._1</td>
                <td class="format-number" data-value="@row._2.toInt">@row._2.toInt</td>
            </tr>
        }
        </tbody>
        <tfoot>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
        </tfoot>
    </table>



    
    <h3>By operating system</h3>

    <p>
        Page views over 10k broken down by operating system version
    </p>
    
    <p>
       total views = @{os.map {_._2}.sum}
    </p>

    <table class="table table-bordered table-striped table-condensed browser-table" data-total="@{os.map {_._2}.sum}">
        <caption>
            <input type="text" class="input-medium search-query" placeholder="Filter...">
        </caption>
        <thead>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
        </thead>
        <tbody>
        @os.toList.sortBy{_._2}.reverse.filter { _._2 >= 10000 }.zipWithIndex.map { case (row, index) =>
            <tr>
                <td>@{index + 1}</td>
                <td>@row._1</td>
                <td class="format-number" data-value="@row._2.toInt">@row._2.toInt</td>
            </tr>
        }
        </tbody>
        <tfoot>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
        </tfoot>
    </table>



    <h2>Browser vendor</h2>
    
    <p>
        Page views over 10k broken down by browser family and version.
    </p>
    
    <p>
       total views = @{browser.map {_._2}.sum}
    </p>

    <table class="table table-bordered table-striped table-condensed browser-table" data-total="@{browser.map {_._2}.sum}">
        <caption>
            <input type="text" class="input-medium search-query" placeholder="Filter...">
        </caption>
        <thead>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
        </thead>
        <tbody>
        @browser.toList.sortBy{_._2}.reverse.filter { _._2 >= 10000 }.zipWithIndex.map { case (row, index) =>
            <tr>
                <td>@{index + 1}</td>
                <td>@row._1</td>
                <td class="format-number" data-value="@row._2.toInt">@row._2.toInt</td>
            </tr>
        }
        </tbody>
        <tfoot>
            <tr>
                <td>Total</td>
                <td></td>
                <td class="total"></td>
            </tr>
        </tfoot>
    </table>
    </table>

    <script>
        curl(['modules/BrowserStats']);
    </script>
}
