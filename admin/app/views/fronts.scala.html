@(env: String)

@admin_main("Fronts editor", env, isAuthed = true) {

    <div class="fronts">

        <div class="finder">
            <h4>Latest
            <input type="text" placeholder="url or keyword" 
                data-bind='event: {keyup: latestArticles.search, mousedown: latestArticles.articleSearch, afterpaste: latestArticles.articleSearch}, value:
                latestArticles.term, valueUpdate: ["afterkeydown", "afterpaste"]'/>
            </h4>

            <div class="connectedList throwAway" data-bind="template: {name: 'template_article', foreach: latestArticles.articles()}"></div>
        </div>

        <div class="listsPicker">            
            <h4>Trail Blocks</h4>
            <div data-bind="foreach: listsAvailable">
                <div><button data-bind="text: $data, click: $parent.displayList"></button></div>
            </div>
            <hr />
            <div>Create a new trailblock</div>
            <input type="text" data-bind="value: newListName"/>
            <button data-bind="click: createList">OK</button>
        </div>

        <div class="lists" data-bind="foreach: listsDisplayed">            
            <h4 data-bind="text: name"></h4>
            <div class="connectedList" data-bind="
                attr: {id: name}, 
                template: {name: 'template_article', foreach: list
            }"></div>
        </div>

        <!--div class="lists">            
            <h4>List A</h4>
            <div id="listA" class="connectedList" data-bind="template: {name: 'template_article', foreach: listA}"></div>

            <h4>List B</h4>
            <div id="listB" class="connectedList" data-bind="template: {name: 'template_article', foreach: listB}"></div>
        </div-->

    </div>

    <script type="text/html" id="template_article">
        <div class="trail cf" data-bind="attr: {'data-url': id}">
            <div class="date" data-bind="html: _humanDate"></div>
            <img data-bind="attr: {src: thumbnail}" />

            <h2 class="webTitle" data-edit="webTitle" data-bind="
                visible: !_editing_webTitle(),
                text: webTitle() ? webTitle : '[webTitle]',
                click: _edit
                "></h2>
            <input type="text" placeholder="webTitle" data-bind="
                visible: _editing_webTitle,
                value: webTitle,
                hasfocus: _editing_webTitle
                "/>

            <h2 class="trailText" data-edit="trailText" data-bind="
                visible: !_editing_trailText(),
                html: trailText() ? trailText : '[trailText]',
                click: _edit
                "></h2>
            <textarea type="text" placeholder="trailText" data-bind="
                visible: _editing_trailText,
                value: trailText,
                hasfocus: _editing_trailText
                "/></textarea>
        </div>
    </script>
    
    <script src="@routes.Assets.at("javascripts/fronts.js")"></script>
}
